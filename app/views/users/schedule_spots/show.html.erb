<turbo-frame id="schedule-spot-modal">
  <div class="relative z-20 w-full max-w-2xl max-h-screen overflow-y-auto bg-main-bg rounded-md">
    <%= render "shared/flash_messages", flash: flash %>
    <main class="flex flex-col justify-center px-8 py-12 bg-main-bg">
      <div class="flex items-center gap-2 mb-8">
        <h1 class="text-2xl font-bold text-text"><%= @schedule_spot.display_name %></h1>
        <% if @schedule_spot.spot.present? && @schedule_spot.spot.google_place_id.present? %>
          <%= link_to "https://maps.google.com/maps?q=place_id:#{@schedule_spot.spot.google_place_id}", target: "_blank", rel: "noopener noreferrer", class: "hover:opacity-70 transition" do %>
            <%= render "shared/icon/map_icon_google" %>
          <% end %>
        <% end %>
      </div>

      <div class="w-full max-w-md">
        <div class="mb-4">
          <label class="block text-sm font-medium text-text mb-2">カテゴリ</label>
          <div class="form-text-field bg-gray-100">
            <%= Category.find_by(id: @schedule_spot.snapshot_category_id)&.name || "---" %>
          </div>
        </div>

        <div class="mb-4">
          <label class="block text-sm font-medium text-text mb-2">住所</label>
          <div class="form-text-field bg-gray-100 truncate">
            <% if @schedule_spot.snapshot_address.present? %>
              <%= @schedule_spot.snapshot_address %>
            <% else %>
              ---
            <% end %>
          </div>
        </div>

        <div class="mb-4">
          <label class="block text-sm font-medium text-text mb-2">URL</label>
          <div class="form-text-field bg-gray-100 truncate">
            <% if @schedule_spot.snapshot_website_url.present? %>
              <%= @schedule_spot.snapshot_website_url %>
            <% else %>
              ---
            <% end %>
          </div>
        </div>

        <div class="mb-4">
          <label class="block text-sm font-medium text-text mb-2">電話</label>
          <div class="form-text-field bg-gray-100 truncate">
            <% if @schedule_spot.snapshot_phone_number.present? %>
              <%= @schedule_spot.snapshot_phone_number %>
            <% else %>
              ---
            <% end %>
          </div>
        </div>

        <div class="mb-4">
          <label class="block text-sm font-medium text-text mb-2">予定時間</label>
          <div class="form-text-field bg-gray-100 truncate">
            <% if @schedule_spot.start_time.present? && @schedule_spot.end_time.present? %>
              <%= @schedule_spot.start_time.strftime('%H:%M') %> ~ <%= @schedule_spot.end_time.strftime('%H:%M') %>
            <% elsif @schedule_spot.start_time.present? %>
              <%= @schedule_spot.start_time.strftime('%H:%M') %>
            <% elsif @schedule_spot.end_time.present? %>
              ~ <%= @schedule_spot.end_time.strftime('%H:%M') %>
            <% else %>
              ---
            <% end %>
          </div>
        </div>

        <div class="mb-4">
          <label class="block text-sm font-medium text-text mb-2">メモ</label>
          <div class="form-text-field bg-gray-100">
            <% if @schedule_spot.memo.present? %>
              <%= @schedule_spot.memo %>
            <% else %>
              ---
            <% end %>
          </div>
        </div>
      </div>

      <div class="flex gap-3 mt-8">
        <%= link_to t('cards.form.edit'), edit_schedule_schedule_spot_path(@schedule, @schedule_spot), class: "btn-main flex-1 text-center" %>
        <%# 削除後のページ遷移とturboの相性が悪いのでturboをfalseにして、確認ダイアログをJSで実装 %>
        <%= link_to t('cards.form.back'), schedule_path(@schedule), data: {turbo_frame: "_top"}, class: "btn-sub flex-1 text-center" %>
      </div>
      <%= button_to t('cards.form.delete'), schedule_schedule_spot_path(@schedule, @schedule_spot), method: :delete, data: { turbo: false }, onclick: "return confirm('このスポットを削除しますか')", class: "btn-danger flex-1 text-center mt-20" %>
    </main>
  </div>
</turbo-frame>
