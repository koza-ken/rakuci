<div class="w-full max-w-2xl">
  <% if schedule.present? %>
    <%# しおり名 %>
    <div class="flex items-start justify-between mb-4 gap-1">
      <h1 class="text-3xl text-text font-bold"><%= schedule.name %></h1>
      <%= render partial: "kebab_menu", locals: { schedule: schedule } %>
    </div>

    <%# スケジュール日程 %>
    <div class="mb-2">
      <p class="text-text">
        <span ><%= t('schedules.show.schedule_dates')%>：</span>
        <span ><%= schedule.formatted_date_range %></span>
      </p>
    </div>

    <%# スポット %>
    <div class="mt-4">
      <div class="flex items-center justify-end gap-3 mb-4">
        <%= link_to t('schedules.show.add_spot_button'), new_schedule_schedule_spot_path(schedule), data: { turbo_frame: "spot-create-modal" }, class: "btn-main w-auto" %>
        <%= link_to schedule_item_list_path(schedule), class: "btn-main p-2 w-auto" do %>
          <%= render "shared/icon/footer_icon_backpack", icon_class: "text-text-light" %>
        <% end %>
      </div>

      <% (1..schedule.days).each do |day| %>
        <%# 日目の見出し %>
        <% formatted_date = schedule.formatted_date_for_day(day) %>
        <h3 class="text-lg font-bold text-text mt-4 mb-2">
          <% if formatted_date %>
            <%= formatted_date %>（<%= day %><%= t('users.schedules.show.day_label') %>）
          <% else %>
            <%= day %><%= t('users.schedules.show.day_label') %>
          <% end %>
        </h3>
        <div class="sortable-day-list space-y-2" data-day-number="<%= day %>" data-schedule-id="<%= schedule.hashid %>">
          <% day_spots = schedule.schedule_spots.where(day_number: day).order(:global_position) %>
          <% if day_spots.any? %>
            <% day_spots.each do |schedule_spot| %>
              <div class="sortable-item" data-spot-id="<%= schedule_spot.hashid %>">
                <%= render schedule_spot %>
              </div>
            <% end %>

          <% end %>
        </div>
      <% end %>
    </div>
  <% else %>
    <p class="text-text text-center mt-8"><%= t('activerecord.models.schedule') %><%= t('schedules.show.no_schedule_message') %></p>
  <% end %>

  <%# 操作ボタン %>
  <div class="mt-16 flex gap-3">
    <%= link_to t('schedules.show.edit'), edit_schedule_path(schedule), class: "btn-main flex-1 text-center" %>
    <%= link_to t('users.schedules.show.back'), schedules_path, class: "btn-sub flex-1 text-center" %>
  </div>

  <%# メモ %>
  <% if schedule.memo.present? %>
    <h2 class="mt-10"><%= t('schedules.show.memo') %></h2>
    <div class="mt-2 p-4 bg-white rounded">
      <p class="text-text"><%= schedule.memo %></p>
    </div>
  <% end %>

  <div class="flex justify-center mt-20">
    <%= button_to t('schedules.show.delete_schedule'), schedule_path(schedule), method: :delete, data: { turbo: false }, onclick: "return confirm('#{t('schedules.show.delete_confirm')}')", class: "btn-danger text-center" %>
  </div>
</div>
