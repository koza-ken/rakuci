<%# コメントが保存済みか %>
<% if @comment.persisted? %>
  <%# フラッシュメッセージを表示 %>
  <%= turbo_stream.update "flash-container", partial: "shared/flash_messages", locals: { flash: flash } %>

  <%# コメントが存在する場合、「まだコメントがありません」を削除 %>
  <% if @card.comments.present? %>
    <%= turbo_stream.remove "no-comments-message" %>
  <% end %>

  <%# 成功時：コメントを追加 %>
  <%= turbo_stream.append "comments_list" do %>
    <%= render "groups/comments/comment", comment: @comment %>
  <% end %>
  <%# フォームをクリア %>
  <%= turbo_stream.replace "comment_form" do %>
    <div id="comment_form" class="pt-2">
      <%= render "groups/comments/form", card: @card, comment: Comment.new %>
    </div>
  <% end %>
<% else %>
  <%# エラー時：フォームをエラー付きで置き換え %>
  <%= turbo_stream.replace "comment_form" do %>
    <div id="comment_form" class="pt-2">
      <%= render "groups/comments/form", card: @card, comment: @comment %>
    </div>
  <% end %>
<% end %>
