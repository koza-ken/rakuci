<%# フラッシュメッセージを表示 %>
<%= turbo_stream.update "flash-container", partial: "shared/flash_messages", locals: { flash: flash } %>

<%# モーダルを閉じる（中身を空にする） %>
<%= turbo_stream.update "card-create-modal", "" %>

<%# 空状態メッセージを削除 %>
<%= turbo_stream.remove (@card.group_card? ? "group_cards_empty_state" : "cards_empty_state") %>

<%# 新規カードを追加 %>
<%= turbo_stream.append (@card.group_card? ? "group_cards_list" : "cards_list"), partial: "cards/card", locals: { card: @card } %>

<% unless @card.group_card? %>
  <%# ユーザーページの場合のみ（ページタイトルとFABボタンを表示） %>
  <%# ページタイトル（h1）を表示 %>
  <%= turbo_stream.replace "cards-page-title" do %>
    <h1 class="text-xl md:text-2xl text-text font-bold"><%= t('cards.index_content.title') %></h1>
  <% end %>
  <%# FABボタンを表示 %>
  <%= turbo_stream.replace "cards-fab-container" do %>
    <div class="fixed bottom-22 right-4 md:right-6 lg:left-[calc(50%+412px)] lg:right-auto z-50" data-controller="modal">
      <%= link_to new_card_path, data: {turbo_frame: "card-create-modal", action: "click->modal#setGroupId", modal_target: "fab"},
                  title: t('cards.index_content.create_card'),
                  class: "group bg-primary hover:opacity-80 text-text-light w-14 h-14 lg:w-18 lg:h-18 rounded-full shadow-lg hover:shadow-xl duration-300 flex items-center justify-center relative" do %>
        <%= render IconComponent.new(name: "add_card_icon", size: 8, breakpoints: { lg: 10 }, color: "text-text-light") %>
      <% end %>
    </div>
  <% end %>
<% end %>
